+ echo 'Beginning trial 6 of 10'
Beginning trial 6 of 10
+ docker exec -it language_model python -c '
import mlperf_logger 
from mlperf_logging.mllog import constants 
mlperf_logger.mlperf_submission_log(constants.BERT)'
:::MLLOG {"namespace": "", "time_ms": 1635311698789, "event_type": "POINT_IN_TIME", "key": "submission_benchmark", "value": "bert", "metadata": {"file": "/workspace/bert/mlperf_logger.py", "lineno": 66}}
:::MLLOG {"namespace": "", "time_ms": 1635311698809, "event_type": "POINT_IN_TIME", "key": "submission_org", "value": "Dell", "metadata": {"file": "/workspace/bert/mlperf_logger.py", "lineno": 71}}
:::MLLOG {"namespace": "", "time_ms": 1635311698809, "event_type": "POINT_IN_TIME", "key": "submission_division", "value": "closed", "metadata": {"file": "/workspace/bert/mlperf_logger.py", "lineno": 75}}
:::MLLOG {"namespace": "", "time_ms": 1635311698809, "event_type": "POINT_IN_TIME", "key": "submission_status", "value": "onprem", "metadata": {"file": "/workspace/bert/mlperf_logger.py", "lineno": 79}}
:::MLLOG {"namespace": "", "time_ms": 1635311698809, "event_type": "POINT_IN_TIME", "key": "submission_platform", "value": "1xDSS8440x8A100-PCIE-40GB", "metadata": {"file": "/workspace/bert/mlperf_logger.py", "lineno": 83}}
+ '[' 1 -eq 1 ']'
+ sync
+ sudo /sbin/sysctl vm.drop_caches=3
vm.drop_caches = 3
+ docker exec -it language_model python -c '
from mlperf_logging.mllog import constants 
from mlperf_logger import log_event 
log_event(key=constants.CACHE_CLEAR, value=True)'
:::MLLOG {"namespace": "", "time_ms": 1635311718920, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
+ docker exec -it --env=BATCHSIZE --env=CUDA_VISIBLE_DEVICES --env=DGXHT --env=DGXNGPU --env=DGXNNODES --env=DGXNSOCKET --env=DGXSOCKETCORES --env=DGXSYSTEM --env=EVAL_ITER_SAMPLES --env=EVAL_ITER_START_SAMPLES --env=EXTRA_PARAMS --env=GRADIENT_STEPS --env=LR --env=MAX_SAMPLES_TERMINATION --env=MAX_STEPS --env=NCCL_P2P_LEVEL --env=NCCL_SOCKET_IFNAME --env=OPT_LAMB_BETA_1 --env=OPT_LAMB_BETA_2 --env=PHASE --env=SLURM_NTASKS --env=START_WARMUP_STEP --env=WALLTIME --env=WARMUP_PROPORTION --env=SEED language_model sh -c ./run_and_time.sh
+ '[' '' = 1 ']'
+ : 48
+ : 1
+ : 3.5e-4
+ : 15000
+ : 2
+ : ''
+ : ''
+ : ''\'''\'''
+ : ''
+ : 7573
+ : 13009
+ : ''
+ : 0
+ : ''
+ : ''
+ : 0
+ : 150000
+ : 150000
+ : 4500000
+ : 0.9
+ : 0.999
+ : 0
+ : 0.720
+ : 0
+ : 0.0
+ : 0.0
+ : 0.01
+ echo 'Run vars: id 13009 gpus  mparams '\'''\'''
Run vars: id 13009 gpus  mparams ''
++ date +%s
+ START=1635311719
++ date '+%Y-%m-%d %r'
+ START_FMT='2021-10-27 05:15:19 AM'
+ echo 'STARTING TIMING RUN AT 2021-10-27 05:15:19 AM'
STARTING TIMING RUN AT 2021-10-27 05:15:19 AM
+ '[' '!' -z '' ']'
+ PHASE1='    --train_batch_size=48     --learning_rate=3.5e-4     --warmup_proportion=0.0     --max_steps=7038     --num_steps_per_checkpoint=2500     --max_seq_length=128     --max_predictions_per_seq=20     --input_dir=/workspace/data     '
+ PHASE2='    --train_batch_size=48     --learning_rate=3.5e-4     --opt_lamb_beta_1=0.9     --opt_lamb_beta_2=0.999     --warmup_proportion=0.0     --warmup_steps=0.0     --start_warmup_step=0     --max_steps=15000     --phase2     --max_seq_length=512     --max_predictions_per_seq=76     --input_dir=/workspace/data_phase2     --init_checkpoint=/workspace/phase1/model.ckpt-28252.pt     '
+ PHASES=("$PHASE1" "$PHASE2")
+ cluster=
+ [[ DSS8440x8A100-PCIE-40GB == DGX2* ]]
+ [[ DSS8440x8A100-PCIE-40GB == DGXA100* ]]
+ source ./config_DSS8440x8A100-PCIE-40GB.sh
++ export BATCHSIZE=48
++ BATCHSIZE=48
++ export GRADIENT_STEPS=1
++ GRADIENT_STEPS=1
++ export LR=3.5e-4
++ LR=3.5e-4
++ export MAX_SAMPLES_TERMINATION=4500000
++ MAX_SAMPLES_TERMINATION=4500000
++ export MAX_STEPS=15000
++ MAX_STEPS=15000
++ export OPT_LAMB_BETA_1=0.9
++ OPT_LAMB_BETA_1=0.9
++ export OPT_LAMB_BETA_2=0.999
++ OPT_LAMB_BETA_2=0.999
++ export START_WARMUP_STEP=0
++ START_WARMUP_STEP=0
++ export WARMUP_PROPORTION=0.0
++ WARMUP_PROPORTION=0.0
++ export 'EXTRA_PARAMS=--dense_seq_output --unpad --unpad_fmha --exchange_padding'
++ EXTRA_PARAMS='--dense_seq_output --unpad --unpad_fmha --exchange_padding'
++ export PHASE=2
++ PHASE=2
++ export EVAL_ITER_START_SAMPLES=150000
++ EVAL_ITER_START_SAMPLES=150000
++ export EVAL_ITER_SAMPLES=150000
++ EVAL_ITER_SAMPLES=150000
++ export DGXNNODES=1
++ DGXNNODES=1
+++ sed 's/^config_//'
+++ sed 's/\.sh$//'
++++ readlink -f ./config_DSS8440x8A100-PCIE-40GB.sh
+++ basename /workspace/bert/config_DSS8440x8A100-PCIE-40GB.sh
++ export DGXSYSTEM=DSS8440x8A100-PCIE-40GB
++ DGXSYSTEM=DSS8440x8A100-PCIE-40GB
++ export WALLTIME=01:15:00
++ WALLTIME=01:15:00
++ source ./config_DSS8440x8A100-PCIE-40GB_common.sh
+++ export DGXNGPU=8
+++ DGXNGPU=8
+++ export DGXSOCKETCORES=24
+++ DGXSOCKETCORES=24
+++ export DGXNSOCKET=2
+++ DGXNSOCKET=2
+++ export DGXHT=2
+++ DGXHT=2
+++ export SLURM_NTASKS=8
+++ SLURM_NTASKS=8
+++ export CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7
+++ CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7
+++ export NCCL_SOCKET_IFNAME=
+++ NCCL_SOCKET_IFNAME=
+++ export NCCL_P2P_LEVEL=1
+++ NCCL_P2P_LEVEL=1
++ export NCCL_DEBUG=INFO
++ NCCL_DEBUG=INFO
+ declare -a CMD
+ '[' -n '' ']'
+ CMD=('python' '-u' '-m' 'bind_pyt' "--nsockets_per_node=${DGXNSOCKET}" "--ncores_per_socket=${DGXSOCKETCORES}" "--nproc_per_node=${DGXNGPU}")
+ BERT_CMD='    python -u -m bind_pyt --nsockets_per_node=2 --ncores_per_socket=24 --nproc_per_node=8          /workspace/bert/run_pretraining.py         --train_batch_size=48     --learning_rate=3.5e-4     --opt_lamb_beta_1=0.9     --opt_lamb_beta_2=0.999     --warmup_proportion=0.0     --warmup_steps=0.0     --start_warmup_step=0     --max_steps=15000     --phase2     --max_seq_length=512     --max_predictions_per_seq=76     --input_dir=/workspace/data_phase2     --init_checkpoint=/workspace/phase1/model.ckpt-28252.pt          --do_train     --skip_checkpoint     --train_mlm_accuracy_window_size=0     --target_mlm_accuracy=0.720     --weight_decay_rate=0.01     --max_samples_termination=4500000     --eval_iter_start_samples=150000 --eval_iter_samples=150000     --eval_batch_size=16 --eval_dir=/workspace/evaldata --num_eval_examples 10000     --cache_eval_data     --output_dir=/results     --fp16 --fused_bias_fc --fused_bias_mha --fused_dropout_add     --distributed_lamb --dwu-num-rs-pg=1 --dwu-num-ar-pg=1 --dwu-num-ag-pg=1 --dwu-num-blocks=1     --gradient_accumulation_steps=1     --log_freq=0     --bert_config_path=/workspace/phase1/bert_config.json '
+ '[' -n '' ']'
+ [[ 0 != 1 ]]
+ BERT_CMD='    python -u -m bind_pyt --nsockets_per_node=2 --ncores_per_socket=24 --nproc_per_node=8          /workspace/bert/run_pretraining.py         --train_batch_size=48     --learning_rate=3.5e-4     --opt_lamb_beta_1=0.9     --opt_lamb_beta_2=0.999     --warmup_proportion=0.0     --warmup_steps=0.0     --start_warmup_step=0     --max_steps=15000     --phase2     --max_seq_length=512     --max_predictions_per_seq=76     --input_dir=/workspace/data_phase2     --init_checkpoint=/workspace/phase1/model.ckpt-28252.pt          --do_train     --skip_checkpoint     --train_mlm_accuracy_window_size=0     --target_mlm_accuracy=0.720     --weight_decay_rate=0.01     --max_samples_termination=4500000     --eval_iter_start_samples=150000 --eval_iter_samples=150000     --eval_batch_size=16 --eval_dir=/workspace/evaldata --num_eval_examples 10000     --cache_eval_data     --output_dir=/results     --fp16 --fused_bias_fc --fused_bias_mha --fused_dropout_add     --distributed_lamb --dwu-num-rs-pg=1 --dwu-num-ar-pg=1 --dwu-num-ag-pg=1 --dwu-num-blocks=1     --gradient_accumulation_steps=1     --log_freq=0     --bert_config_path=/workspace/phase1/bert_config.json  --allreduce_post_accumulation --allreduce_post_accumulation_fp16'
+ BERT_CMD='    python -u -m bind_pyt --nsockets_per_node=2 --ncores_per_socket=24 --nproc_per_node=8          /workspace/bert/run_pretraining.py         --train_batch_size=48     --learning_rate=3.5e-4     --opt_lamb_beta_1=0.9     --opt_lamb_beta_2=0.999     --warmup_proportion=0.0     --warmup_steps=0.0     --start_warmup_step=0     --max_steps=15000     --phase2     --max_seq_length=512     --max_predictions_per_seq=76     --input_dir=/workspace/data_phase2     --init_checkpoint=/workspace/phase1/model.ckpt-28252.pt          --do_train     --skip_checkpoint     --train_mlm_accuracy_window_size=0     --target_mlm_accuracy=0.720     --weight_decay_rate=0.01     --max_samples_termination=4500000     --eval_iter_start_samples=150000 --eval_iter_samples=150000     --eval_batch_size=16 --eval_dir=/workspace/evaldata --num_eval_examples 10000     --cache_eval_data     --output_dir=/results     --fp16 --fused_bias_fc --fused_bias_mha --fused_dropout_add     --distributed_lamb --dwu-num-rs-pg=1 --dwu-num-ar-pg=1 --dwu-num-ag-pg=1 --dwu-num-blocks=1     --gradient_accumulation_steps=1     --log_freq=0     --bert_config_path=/workspace/phase1/bert_config.json  --allreduce_post_accumulation --allreduce_post_accumulation_fp16  --dense_seq_output --unpad --unpad_fmha --exchange_padding '
+ [[ 0 != 0 ]]
+ '[' '' = apiLog.sh ']'
+ '[' '' = 1 ']'
+ eval '     python -u -m bind_pyt --nsockets_per_node=2 --ncores_per_socket=24 --nproc_per_node=8          /workspace/bert/run_pretraining.py         --train_batch_size=48     --learning_rate=3.5e-4     --opt_lamb_beta_1=0.9     --opt_lamb_beta_2=0.999     --warmup_proportion=0.0     --warmup_steps=0.0     --start_warmup_step=0     --max_steps=15000     --phase2     --max_seq_length=512     --max_predictions_per_seq=76     --input_dir=/workspace/data_phase2     --init_checkpoint=/workspace/phase1/model.ckpt-28252.pt          --do_train     --skip_checkpoint     --train_mlm_accuracy_window_size=0     --target_mlm_accuracy=0.720     --weight_decay_rate=0.01     --max_samples_termination=4500000     --eval_iter_start_samples=150000 --eval_iter_samples=150000     --eval_batch_size=16 --eval_dir=/workspace/evaldata --num_eval_examples 10000     --cache_eval_data     --output_dir=/results     --fp16 --fused_bias_fc --fused_bias_mha --fused_dropout_add     --distributed_lamb --dwu-num-rs-pg=1 --dwu-num-ar-pg=1 --dwu-num-ag-pg=1 --dwu-num-blocks=1     --gradient_accumulation_steps=1     --log_freq=0     --bert_config_path=/workspace/phase1/bert_config.json  --allreduce_post_accumulation --allreduce_post_accumulation_fp16  --dense_seq_output --unpad --unpad_fmha --exchange_padding  --seed=7573'
++ python -u -m bind_pyt --nsockets_per_node=2 --ncores_per_socket=24 --nproc_per_node=8 /workspace/bert/run_pretraining.py --train_batch_size=48 --learning_rate=3.5e-4 --opt_lamb_beta_1=0.9 --opt_lamb_beta_2=0.999 --warmup_proportion=0.0 --warmup_steps=0.0 --start_warmup_step=0 --max_steps=15000 --phase2 --max_seq_length=512 --max_predictions_per_seq=76 --input_dir=/workspace/data_phase2 --init_checkpoint=/workspace/phase1/model.ckpt-28252.pt --do_train --skip_checkpoint --train_mlm_accuracy_window_size=0 --target_mlm_accuracy=0.720 --weight_decay_rate=0.01 --max_samples_termination=4500000 --eval_iter_start_samples=150000 --eval_iter_samples=150000 --eval_batch_size=16 --eval_dir=/workspace/evaldata --num_eval_examples 10000 --cache_eval_data --output_dir=/results --fp16 --fused_bias_fc --fused_bias_mha --fused_dropout_add --distributed_lamb --dwu-num-rs-pg=1 --dwu-num-ar-pg=1 --dwu-num-ag-pg=1 --dwu-num-blocks=1 --gradient_accumulation_steps=1 --log_freq=0 --bert_config_path=/workspace/phase1/bert_config.json --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --dense_seq_output --unpad --unpad_fmha --exchange_padding --seed=7573
:::MLLOG {"namespace": "", "time_ms": 1635311721491, "event_type": "INTERVAL_START", "key": "init_start", "value": null, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1072}}
:::MLLOG {"namespace": "", "time_ms": 1635311721515, "event_type": "INTERVAL_START", "key": "init_start", "value": null, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1072}}
:::MLLOG {"namespace": "", "time_ms": 1635311721522, "event_type": "INTERVAL_START", "key": "init_start", "value": null, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1072}}
:::MLLOG {"namespace": "", "time_ms": 1635311721578, "event_type": "INTERVAL_START", "key": "init_start", "value": null, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1072}}
:::MLLOG {"namespace": "", "time_ms": 1635311721588, "event_type": "INTERVAL_START", "key": "init_start", "value": null, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1072}}
:::MLLOG {"namespace": "", "time_ms": 1635311721599, "event_type": "INTERVAL_START", "key": "init_start", "value": null, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1072}}
:::MLLOG {"namespace": "", "time_ms": 1635311721614, "event_type": "INTERVAL_START", "key": "init_start", "value": null, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1072}}
:::MLLOG {"namespace": "", "time_ms": 1635311721620, "event_type": "INTERVAL_START", "key": "init_start", "value": null, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1072}}
device: cuda:0 n_gpu: 8, distributed training: True, 16-bits training: True
:::MLLOG {"namespace": "", "time_ms": 1635311722677, "event_type": "POINT_IN_TIME", "key": "submission_benchmark", "value": "bert", "metadata": {"file": "/workspace/bert/mlperf_logger.py", "lineno": 66}}
:::MLLOG {"namespace": "", "time_ms": 1635311722677, "event_type": "POINT_IN_TIME", "key": "submission_org", "value": "Dell", "metadata": {"file": "/workspace/bert/mlperf_logger.py", "lineno": 71}}
:::MLLOG {"namespace": "", "time_ms": 1635311722677, "event_type": "POINT_IN_TIME", "key": "submission_division", "value": "closed", "metadata": {"file": "/workspace/bert/mlperf_logger.py", "lineno": 75}}
:::MLLOG {"namespace": "", "time_ms": 1635311722678, "event_type": "POINT_IN_TIME", "key": "submission_status", "value": "onprem", "metadata": {"file": "/workspace/bert/mlperf_logger.py", "lineno": 79}}
:::MLLOG {"namespace": "", "time_ms": 1635311722678, "event_type": "POINT_IN_TIME", "key": "submission_platform", "value": "1xDSS8440x8A100-PCIE-40GB", "metadata": {"file": "/workspace/bert/mlperf_logger.py", "lineno": 83}}
:::MLLOG {"namespace": "", "time_ms": 1635311722678, "event_type": "POINT_IN_TIME", "key": "seed", "value": 7573, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1095}}
:::MLLOG {"namespace": "", "time_ms": 1635311722678, "event_type": "POINT_IN_TIME", "key": "global_batch_size", "value": 384, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1097}}
:::MLLOG {"namespace": "", "time_ms": 1635311722678, "event_type": "POINT_IN_TIME", "key": "d_batch_size", "value": 48, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1099}}
:::MLLOG {"namespace": "", "time_ms": 1635311722678, "event_type": "POINT_IN_TIME", "key": "gradient_accumulation_steps", "value": 1, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1101}}
:::MLLOG {"namespace": "", "time_ms": 1635311722678, "event_type": "POINT_IN_TIME", "key": "max_predictions_per_seq", "value": 76, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1103}}
:::MLLOG {"namespace": "", "time_ms": 1635311722678, "event_type": "POINT_IN_TIME", "key": "opt_learning_rate_training_steps", "value": 15000.0, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1105}}
:::MLLOG {"namespace": "", "time_ms": 1635311722678, "event_type": "POINT_IN_TIME", "key": "num_warmup_steps", "value": 0, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1107}}
parsed args:
Namespace(allreduce_post_accumulation=True, allreduce_post_accumulation_fp16=True, bert_config_path='/workspace/phase1/bert_config.json', bert_model='bert-large-uncased', bypass_amp=False, cache_eval_data=True, checkpoint_activations=False, cuda_graph_mode='segmented', ddp_type='apex', dense_seq_output=True, device=device(type='cuda', index=0), disable_apex_softmax=False, disable_fuse_mask=False, disable_fuse_qkv=False, disable_fuse_scale=False, distributed_lamb=True, do_train=True, dwu_e5m2_allgather=False, dwu_group_size=0, dwu_num_ag_pg=1, dwu_num_ar_pg=1, dwu_num_blocks=1, dwu_num_chunks=1, dwu_num_rs_pg=1, dwu_overlap_reductions=False, enable_fuse_dropout=False, enable_stream=False, eval_batch_size=16, eval_dir='/workspace/evaldata', eval_iter_samples=150000, eval_iter_start_samples=150000, exchange_padding=True, fp16=True, fused_bias_fc=True, fused_bias_mha=True, fused_dropout_add=True, fused_gelu_bias=False, fused_mha=False, gradient_accumulation_steps=1, init_checkpoint='/workspace/phase1/model.ckpt-28252.pt', init_tf_checkpoint=None, input_dir='/workspace/data_phase2', keep_n_most_recent_checkpoints=20, learning_rate=0.00035, local_rank=0, log_freq=0.0, loss_scale=0.0, max_iterations_per_graph=4, max_predictions_per_seq=76, max_samples_termination=4500000.0, max_seq_length=512, max_steps=15000.0, min_samples_to_start_checkpoints=3000000, n_gpu=8, num_epochs_to_generate_seeds_for=2, num_eval_examples=10000, num_samples_per_checkpoint=500000, opt_lamb_beta_1=0.9, opt_lamb_beta_2=0.999, output_dir='/results', pad=False, pad_fmha=False, phase2=True, resume_from_checkpoint=False, seed=7573, skip_checkpoint=True, start_warmup_step=0.0, target_mlm_accuracy=0.72, train_batch_size=48, train_mlm_accuracy_window_size=0, unpad=True, unpad_fmha=True, use_cuda_graph=False, use_ddp=False, use_env=False, use_gradient_as_bucket_view=False, warmup_proportion=0.0, warmup_steps=0.0, weight_decay_rate=0.01)
device: cuda:2 n_gpu: 8, distributed training: True, 16-bits training: True
device: cuda:6 n_gpu: 8, distributed training: True, 16-bits training: True
device: cuda:3 n_gpu: 8, distributed training: True, 16-bits training: True
device: cuda:1 n_gpu: 8, distributed training: True, 16-bits training: True
device: cuda:5 n_gpu: 8, distributed training: True, 16-bits training: True
device: cuda:4 n_gpu: 8, distributed training: True, 16-bits training: True
device: cuda:7 n_gpu: 8, distributed training: True, 16-bits training: True
:::MLLOG {"namespace": "", "time_ms": 1635311731815, "event_type": "POINT_IN_TIME", "key": "opt_base_learning_rate", "value": 0.00035, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 699}}
node071:32499:32499 [0] NCCL INFO Bootstrap : Using eth0:10.141.0.71<0>
node071:32499:32499 [0] NCCL INFO Plugin Path : /opt/hpcx/nccl_rdma_sharp_plugin/lib/libnccl-net.so
node071:32499:32499 [0] NCCL INFO P2P plugin IBext
node071:32499:32499 [0] NCCL INFO NET/IB : No device found.
node071:32499:32499 [0] NCCL INFO NET/IB : No device found.
node071:32499:32499 [0] NCCL INFO NET/Socket : Using [0]eth0:10.141.0.71<0>
node071:32499:32499 [0] NCCL INFO Using network Socket
NCCL version 2.11.4+cuda11.4
node071:32502:32502 [3] NCCL INFO Bootstrap : Using eth0:10.141.0.71<0>
node071:32506:32506 [7] NCCL INFO Bootstrap : Using eth0:10.141.0.71<0>
node071:32504:32504 [5] NCCL INFO Bootstrap : Using eth0:10.141.0.71<0>
node071:32503:32503 [4] NCCL INFO Bootstrap : Using eth0:10.141.0.71<0>
node071:32506:32506 [7] NCCL INFO Plugin Path : /opt/hpcx/nccl_rdma_sharp_plugin/lib/libnccl-net.so
node071:32504:32504 [5] NCCL INFO Plugin Path : /opt/hpcx/nccl_rdma_sharp_plugin/lib/libnccl-net.so
node071:32502:32502 [3] NCCL INFO Plugin Path : /opt/hpcx/nccl_rdma_sharp_plugin/lib/libnccl-net.so
node071:32506:32506 [7] NCCL INFO P2P plugin IBext
node071:32504:32504 [5] NCCL INFO P2P plugin IBext
node071:32502:32502 [3] NCCL INFO P2P plugin IBext
node071:32503:32503 [4] NCCL INFO Plugin Path : /opt/hpcx/nccl_rdma_sharp_plugin/lib/libnccl-net.so
node071:32503:32503 [4] NCCL INFO P2P plugin IBext
node071:32503:32503 [4] NCCL INFO NET/IB : No device found.
node071:32506:32506 [7] NCCL INFO NET/IB : No device found.
node071:32504:32504 [5] NCCL INFO NET/IB : No device found.
node071:32502:32502 [3] NCCL INFO NET/IB : No device found.
node071:32503:32503 [4] NCCL INFO NET/IB : No device found.
node071:32504:32504 [5] NCCL INFO NET/IB : No device found.
node071:32506:32506 [7] NCCL INFO NET/IB : No device found.
node071:32502:32502 [3] NCCL INFO NET/IB : No device found.
node071:32503:32503 [4] NCCL INFO NET/Socket : Using [0]eth0:10.141.0.71<0>
node071:32503:32503 [4] NCCL INFO Using network Socket
node071:32504:32504 [5] NCCL INFO NET/Socket : Using [0]eth0:10.141.0.71<0>
node071:32502:32502 [3] NCCL INFO NET/Socket : Using [0]eth0:10.141.0.71<0>
node071:32506:32506 [7] NCCL INFO NET/Socket : Using [0]eth0:10.141.0.71<0>
node071:32504:32504 [5] NCCL INFO Using network Socket
node071:32502:32502 [3] NCCL INFO Using network Socket
node071:32506:32506 [7] NCCL INFO Using network Socket
node071:32505:32505 [6] NCCL INFO Bootstrap : Using eth0:10.141.0.71<0>
node071:32500:32500 [1] NCCL INFO Bootstrap : Using eth0:10.141.0.71<0>
node071:32501:32501 [2] NCCL INFO Bootstrap : Using eth0:10.141.0.71<0>
node071:32505:32505 [6] NCCL INFO Plugin Path : /opt/hpcx/nccl_rdma_sharp_plugin/lib/libnccl-net.so
node071:32505:32505 [6] NCCL INFO P2P plugin IBext
node071:32505:32505 [6] NCCL INFO NET/IB : No device found.
node071:32505:32505 [6] NCCL INFO NET/IB : No device found.
node071:32500:32500 [1] NCCL INFO Plugin Path : /opt/hpcx/nccl_rdma_sharp_plugin/lib/libnccl-net.so
node071:32500:32500 [1] NCCL INFO P2P plugin IBext
node071:32501:32501 [2] NCCL INFO Plugin Path : /opt/hpcx/nccl_rdma_sharp_plugin/lib/libnccl-net.so
node071:32501:32501 [2] NCCL INFO P2P plugin IBext
node071:32505:32505 [6] NCCL INFO NET/Socket : Using [0]eth0:10.141.0.71<0>
node071:32505:32505 [6] NCCL INFO Using network Socket
node071:32500:32500 [1] NCCL INFO NET/IB : No device found.
node071:32501:32501 [2] NCCL INFO NET/IB : No device found.
node071:32501:32501 [2] NCCL INFO NET/IB : No device found.
node071:32500:32500 [1] NCCL INFO NET/IB : No device found.
node071:32500:32500 [1] NCCL INFO NET/Socket : Using [0]eth0:10.141.0.71<0>
node071:32501:32501 [2] NCCL INFO NET/Socket : Using [0]eth0:10.141.0.71<0>
node071:32500:32500 [1] NCCL INFO Using network Socket
node071:32501:32501 [2] NCCL INFO Using network Socket
node071:32499:32749 [0] NCCL INFO NCCL_P2P_LEVEL set by environment to PIX
node071:32504:32752 [5] NCCL INFO NCCL_P2P_LEVEL set by environment to PIX
node071:32503:32750 [4] NCCL INFO NCCL_P2P_LEVEL set by environment to PIX
node071:32500:32756 [1] NCCL INFO NCCL_P2P_LEVEL set by environment to PIX
node071:32501:32755 [2] NCCL INFO NCCL_P2P_LEVEL set by environment to PIX
node071:32502:32753 [3] NCCL INFO NCCL_P2P_LEVEL set by environment to PIX
node071:32505:32754 [6] NCCL INFO NCCL_P2P_LEVEL set by environment to PIX
node071:32506:32751 [7] NCCL INFO NCCL_P2P_LEVEL set by environment to PIX
node071:32506:32751 [7] NCCL INFO Trees [0] -1/-1/-1->7->6 [1] -1/-1/-1->7->6
node071:32506:32751 [7] NCCL INFO Setting affinity for GPU 7 to a8000000,0000a800,00000000
node071:32499:32749 [0] NCCL INFO Channel 00/02 :    0   1   2   3   4   5   6   7
node071:32499:32749 [0] NCCL INFO Channel 01/02 :    0   1   2   3   4   5   6   7
node071:32499:32749 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1
node071:32499:32749 [0] NCCL INFO Setting affinity for GPU 0 to 150000,00000015
node071:32502:32753 [3] NCCL INFO Trees [0] 4/-1/-1->3->2 [1] 4/-1/-1->3->2
node071:32501:32755 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] 3/-1/-1->2->1
node071:32500:32756 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 2/-1/-1->1->0
node071:32502:32753 [3] NCCL INFO Setting affinity for GPU 3 to 54,00000000,00540000
node071:32503:32750 [4] NCCL INFO Trees [0] 5/-1/-1->4->3 [1] 5/-1/-1->4->3
node071:32501:32755 [2] NCCL INFO Setting affinity for GPU 2 to 01,50000000,00015000
node071:32505:32754 [6] NCCL INFO Trees [0] 7/-1/-1->6->5 [1] 7/-1/-1->6->5
node071:32504:32752 [5] NCCL INFO Trees [0] 6/-1/-1->5->4 [1] 6/-1/-1->5->4
node071:32500:32756 [1] NCCL INFO Setting affinity for GPU 1 to 05400000,00000540
node071:32503:32750 [4] NCCL INFO Setting affinity for GPU 4 to 2a00,00000000,2a000000
node071:32505:32754 [6] NCCL INFO Setting affinity for GPU 6 to 02a00000,000002a0,00000000
node071:32504:32752 [5] NCCL INFO Setting affinity for GPU 5 to 0a8000,0000000a,80000000
node071:32506:32751 [7] NCCL INFO Channel 00 : 7[c3000] -> 0[12000] via direct shared memory
node071:32506:32751 [7] NCCL INFO Channel 01 : 7[c3000] -> 0[12000] via direct shared memory
node071:32504:32752 [5] NCCL INFO Channel 00 : 5[8b000] -> 6[c1000] via direct shared memory
node071:32500:32756 [1] NCCL INFO Channel 00 : 1[14000] -> 2[48000] via direct shared memory
node071:32502:32753 [3] NCCL INFO Channel 00 : 3[4a000] -> 4[89000] via direct shared memory
node071:32504:32752 [5] NCCL INFO Channel 01 : 5[8b000] -> 6[c1000] via direct shared memory
node071:32500:32756 [1] NCCL INFO Channel 01 : 1[14000] -> 2[48000] via direct shared memory
node071:32502:32753 [3] NCCL INFO Channel 01 : 3[4a000] -> 4[89000] via direct shared memory
node071:32499:32749 [0] NCCL INFO Channel 00 : 0[12000] -> 1[14000] via P2P/IPC
node071:32503:32750 [4] NCCL INFO Channel 00 : 4[89000] -> 5[8b000] via P2P/IPC
node071:32499:32749 [0] NCCL INFO Channel 01 : 0[12000] -> 1[14000] via P2P/IPC
node071:32501:32755 [2] NCCL INFO Channel 00 : 2[48000] -> 3[4a000] via P2P/IPC
node071:32505:32754 [6] NCCL INFO Channel 00 : 6[c1000] -> 7[c3000] via P2P/IPC
node071:32503:32750 [4] NCCL INFO Channel 01 : 4[89000] -> 5[8b000] via P2P/IPC
node071:32505:32754 [6] NCCL INFO Channel 01 : 6[c1000] -> 7[c3000] via P2P/IPC
node071:32501:32755 [2] NCCL INFO Channel 01 : 2[48000] -> 3[4a000] via P2P/IPC
node071:32499:32749 [0] NCCL INFO Connected all rings
node071:32503:32750 [4] NCCL INFO Connected all rings
node071:32502:32753 [3] NCCL INFO Connected all rings
node071:32504:32752 [5] NCCL INFO Connected all rings
node071:32500:32756 [1] NCCL INFO Connected all rings
node071:32506:32751 [7] NCCL INFO Connected all rings
node071:32505:32754 [6] NCCL INFO Connected all rings
node071:32501:32755 [2] NCCL INFO Connected all rings
node071:32506:32751 [7] NCCL INFO Channel 00 : 7[c3000] -> 6[c1000] via P2P/IPC
node071:32503:32750 [4] NCCL INFO Channel 00 : 4[89000] -> 3[4a000] via direct shared memory
node071:32503:32750 [4] NCCL INFO Channel 01 : 4[89000] -> 3[4a000] via direct shared memory
node071:32506:32751 [7] NCCL INFO Channel 01 : 7[c3000] -> 6[c1000] via P2P/IPC
node071:32505:32754 [6] NCCL INFO Channel 00 : 6[c1000] -> 5[8b000] via direct shared memory
node071:32505:32754 [6] NCCL INFO Channel 01 : 6[c1000] -> 5[8b000] via direct shared memory
node071:32501:32755 [2] NCCL INFO Channel 00 : 2[48000] -> 1[14000] via direct shared memory
node071:32506:32751 [7] NCCL INFO Connected all trees
node071:32506:32751 [7] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32506:32751 [7] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32501:32755 [2] NCCL INFO Channel 01 : 2[48000] -> 1[14000] via direct shared memory
node071:32504:32752 [5] NCCL INFO Channel 00 : 5[8b000] -> 4[89000] via P2P/IPC
node071:32502:32753 [3] NCCL INFO Channel 00 : 3[4a000] -> 2[48000] via P2P/IPC
node071:32500:32756 [1] NCCL INFO Channel 00 : 1[14000] -> 0[12000] via P2P/IPC
node071:32504:32752 [5] NCCL INFO Channel 01 : 5[8b000] -> 4[89000] via P2P/IPC
node071:32500:32756 [1] NCCL INFO Channel 01 : 1[14000] -> 0[12000] via P2P/IPC
node071:32502:32753 [3] NCCL INFO Channel 01 : 3[4a000] -> 2[48000] via P2P/IPC
node071:32499:32749 [0] NCCL INFO Connected all trees
node071:32499:32749 [0] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32499:32749 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32504:32752 [5] NCCL INFO Connected all trees
node071:32504:32752 [5] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32504:32752 [5] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32500:32756 [1] NCCL INFO Connected all trees
node071:32500:32756 [1] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32500:32756 [1] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32502:32753 [3] NCCL INFO Connected all trees
node071:32502:32753 [3] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32502:32753 [3] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32505:32754 [6] NCCL INFO Connected all trees
node071:32505:32754 [6] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32505:32754 [6] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32501:32755 [2] NCCL INFO Connected all trees
node071:32501:32755 [2] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32501:32755 [2] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32503:32750 [4] NCCL INFO Connected all trees
node071:32503:32750 [4] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32503:32750 [4] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32499:32749 [0] NCCL INFO comm 0x7ffd24008fb0 rank 0 nranks 8 cudaDev 0 busId 12000 - Init COMPLETE
node071:32504:32752 [5] NCCL INFO comm 0x7ffd2c008fb0 rank 5 nranks 8 cudaDev 5 busId 8b000 - Init COMPLETE
node071:32506:32751 [7] NCCL INFO comm 0x7ffd34008fb0 rank 7 nranks 8 cudaDev 7 busId c3000 - Init COMPLETE
node071:32505:32754 [6] NCCL INFO comm 0x7ffd34008fb0 rank 6 nranks 8 cudaDev 6 busId c1000 - Init COMPLETE
node071:32503:32750 [4] NCCL INFO comm 0x7ffd34008fb0 rank 4 nranks 8 cudaDev 4 busId 89000 - Init COMPLETE
node071:32502:32753 [3] NCCL INFO comm 0x7ffd34008fb0 rank 3 nranks 8 cudaDev 3 busId 4a000 - Init COMPLETE
node071:32500:32756 [1] NCCL INFO comm 0x7ffd30008fb0 rank 1 nranks 8 cudaDev 1 busId 14000 - Init COMPLETE
node071:32501:32755 [2] NCCL INFO comm 0x7ffd34008fb0 rank 2 nranks 8 cudaDev 2 busId 48000 - Init COMPLETE
node071:32499:32499 [0] NCCL INFO Launch mode Parallel
node071:32499:32774 [0] NCCL INFO Channel 00/02 :    0   1   2   3   4   5   6   7
node071:32499:32774 [0] NCCL INFO Channel 01/02 :    0   1   2   3   4   5   6   7
node071:32499:32774 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1
node071:32499:32774 [0] NCCL INFO Setting affinity for GPU 0 to 150000,00000015
node071:32500:32780 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 2/-1/-1->1->0
node071:32500:32780 [1] NCCL INFO Setting affinity for GPU 1 to 05400000,00000540
node071:32501:32779 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] 3/-1/-1->2->1
node071:32501:32779 [2] NCCL INFO Setting affinity for GPU 2 to 01,50000000,00015000
node071:32502:32778 [3] NCCL INFO Trees [0] 4/-1/-1->3->2 [1] 4/-1/-1->3->2
node071:32502:32778 [3] NCCL INFO Setting affinity for GPU 3 to 54,00000000,00540000
node071:32503:32777 [4] NCCL INFO Trees [0] 5/-1/-1->4->3 [1] 5/-1/-1->4->3
node071:32503:32777 [4] NCCL INFO Setting affinity for GPU 4 to 2a00,00000000,2a000000
node071:32504:32776 [5] NCCL INFO Trees [0] 6/-1/-1->5->4 [1] 6/-1/-1->5->4
node071:32504:32776 [5] NCCL INFO Setting affinity for GPU 5 to 0a8000,0000000a,80000000
node071:32505:32781 [6] NCCL INFO Trees [0] 7/-1/-1->6->5 [1] 7/-1/-1->6->5
node071:32505:32781 [6] NCCL INFO Setting affinity for GPU 6 to 02a00000,000002a0,00000000
node071:32506:32775 [7] NCCL INFO Trees [0] -1/-1/-1->7->6 [1] -1/-1/-1->7->6
node071:32506:32775 [7] NCCL INFO Setting affinity for GPU 7 to a8000000,0000a800,00000000
node071:32500:32780 [1] NCCL INFO Channel 00 : 1[14000] -> 2[48000] via direct shared memory
node071:32504:32776 [5] NCCL INFO Channel 00 : 5[8b000] -> 6[c1000] via direct shared memory
node071:32502:32778 [3] NCCL INFO Channel 00 : 3[4a000] -> 4[89000] via direct shared memory
node071:32506:32775 [7] NCCL INFO Channel 00 : 7[c3000] -> 0[12000] via direct shared memory
node071:32500:32780 [1] NCCL INFO Channel 01 : 1[14000] -> 2[48000] via direct shared memory
node071:32504:32776 [5] NCCL INFO Channel 01 : 5[8b000] -> 6[c1000] via direct shared memory
node071:32502:32778 [3] NCCL INFO Channel 01 : 3[4a000] -> 4[89000] via direct shared memory
node071:32506:32775 [7] NCCL INFO Channel 01 : 7[c3000] -> 0[12000] via direct shared memory
node071:32501:32779 [2] NCCL INFO Channel 00 : 2[48000] -> 3[4a000] via P2P/IPC
node071:32503:32777 [4] NCCL INFO Channel 00 : 4[89000] -> 5[8b000] via P2P/IPC
node071:32505:32781 [6] NCCL INFO Channel 00 : 6[c1000] -> 7[c3000] via P2P/IPC
node071:32499:32774 [0] NCCL INFO Channel 00 : 0[12000] -> 1[14000] via P2P/IPC
node071:32501:32779 [2] NCCL INFO Channel 01 : 2[48000] -> 3[4a000] via P2P/IPC
node071:32503:32777 [4] NCCL INFO Channel 01 : 4[89000] -> 5[8b000] via P2P/IPC
node071:32505:32781 [6] NCCL INFO Channel 01 : 6[c1000] -> 7[c3000] via P2P/IPC
node071:32499:32774 [0] NCCL INFO Channel 01 : 0[12000] -> 1[14000] via P2P/IPC
node071:32501:32779 [2] NCCL INFO Connected all rings
node071:32503:32777 [4] NCCL INFO Connected all rings
node071:32505:32781 [6] NCCL INFO Connected all rings
node071:32502:32778 [3] NCCL INFO Connected all rings
node071:32504:32776 [5] NCCL INFO Connected all rings
node071:32499:32774 [0] NCCL INFO Connected all rings
node071:32500:32780 [1] NCCL INFO Connected all rings
node071:32506:32775 [7] NCCL INFO Connected all rings
node071:32506:32775 [7] NCCL INFO Channel 00 : 7[c3000] -> 6[c1000] via P2P/IPC
node071:32501:32779 [2] NCCL INFO Channel 00 : 2[48000] -> 1[14000] via direct shared memory
node071:32503:32777 [4] NCCL INFO Channel 00 : 4[89000] -> 3[4a000] via direct shared memory
node071:32501:32779 [2] NCCL INFO Channel 01 : 2[48000] -> 1[14000] via direct shared memory
node071:32506:32775 [7] NCCL INFO Channel 01 : 7[c3000] -> 6[c1000] via P2P/IPC
node071:32505:32781 [6] NCCL INFO Channel 00 : 6[c1000] -> 5[8b000] via direct shared memory
node071:32503:32777 [4] NCCL INFO Channel 01 : 4[89000] -> 3[4a000] via direct shared memory
node071:32505:32781 [6] NCCL INFO Channel 01 : 6[c1000] -> 5[8b000] via direct shared memory
node071:32506:32775 [7] NCCL INFO Connected all trees
node071:32506:32775 [7] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32506:32775 [7] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32502:32778 [3] NCCL INFO Channel 00 : 3[4a000] -> 2[48000] via P2P/IPC
node071:32504:32776 [5] NCCL INFO Channel 00 : 5[8b000] -> 4[89000] via P2P/IPC
node071:32500:32780 [1] NCCL INFO Channel 00 : 1[14000] -> 0[12000] via P2P/IPC
node071:32502:32778 [3] NCCL INFO Channel 01 : 3[4a000] -> 2[48000] via P2P/IPC
node071:32504:32776 [5] NCCL INFO Channel 01 : 5[8b000] -> 4[89000] via P2P/IPC
node071:32500:32780 [1] NCCL INFO Channel 01 : 1[14000] -> 0[12000] via P2P/IPC
node071:32499:32774 [0] NCCL INFO Connected all trees
node071:32499:32774 [0] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32499:32774 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32502:32778 [3] NCCL INFO Connected all trees
node071:32502:32778 [3] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32502:32778 [3] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32504:32776 [5] NCCL INFO Connected all trees
node071:32504:32776 [5] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32504:32776 [5] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32505:32781 [6] NCCL INFO Connected all trees
node071:32505:32781 [6] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32505:32781 [6] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32503:32777 [4] NCCL INFO Connected all trees
node071:32503:32777 [4] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32503:32777 [4] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32501:32779 [2] NCCL INFO Connected all trees
node071:32501:32779 [2] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32501:32779 [2] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32500:32780 [1] NCCL INFO Connected all trees
node071:32500:32780 [1] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32500:32780 [1] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32499:32774 [0] NCCL INFO comm 0x7ffd10008fb0 rank 0 nranks 8 cudaDev 0 busId 12000 - Init COMPLETE
node071:32499:32499 [0] NCCL INFO Launch mode Parallel
node071:32505:32781 [6] NCCL INFO comm 0x7ffd34384d10 rank 6 nranks 8 cudaDev 6 busId c1000 - Init COMPLETE
node071:32506:32775 [7] NCCL INFO comm 0x7ffd34381330 rank 7 nranks 8 cudaDev 7 busId c3000 - Init COMPLETE
node071:32504:32776 [5] NCCL INFO comm 0x7ffd2c384cd0 rank 5 nranks 8 cudaDev 5 busId 8b000 - Init COMPLETE
node071:32502:32778 [3] NCCL INFO comm 0x7ffd34384af0 rank 3 nranks 8 cudaDev 3 busId 4a000 - Init COMPLETE
node071:32501:32779 [2] NCCL INFO comm 0x7ffd34384d10 rank 2 nranks 8 cudaDev 2 busId 48000 - Init COMPLETE
node071:32503:32777 [4] NCCL INFO comm 0x7ffd34385030 rank 4 nranks 8 cudaDev 4 busId 89000 - Init COMPLETE
node071:32500:32780 [1] NCCL INFO comm 0x7ffd30384ff0 rank 1 nranks 8 cudaDev 1 busId 14000 - Init COMPLETE
:::MLLOG {"namespace": "", "time_ms": 1635311734850, "event_type": "POINT_IN_TIME", "key": "opt_epsilon", "value": 1e-06, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 731}}
:::MLLOG {"namespace": "", "time_ms": 1635311734851, "event_type": "POINT_IN_TIME", "key": "opt_lamb_beta_1", "value": 0.9, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 734}}
:::MLLOG {"namespace": "", "time_ms": 1635311734851, "event_type": "POINT_IN_TIME", "key": "opt_lamb_beta_2", "value": 0.999, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 735}}
:::MLLOG {"namespace": "", "time_ms": 1635311734851, "event_type": "POINT_IN_TIME", "key": "opt_lamb_weight_decay_rate", "value": 0.0, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 736}}
:::MLLOG {"namespace": "", "time_ms": 1635311735119, "event_type": "POINT_IN_TIME", "key": "opt_learning_rate_warmup_steps", "value": 0, "metadata": {"file": "/workspace/bert/schedulers.py", "lineno": 86}}
:::MLLOG {"namespace": "", "time_ms": 1635311735120, "event_type": "POINT_IN_TIME", "key": "opt_lamb_learning_rate_decay_poly_power", "value": 1.0, "metadata": {"file": "/workspace/bert/schedulers.py", "lineno": 87}}
:::MLLOG {"namespace": "", "time_ms": 1635311735120, "event_type": "POINT_IN_TIME", "key": "start_warmup_step", "value": 0, "metadata": {"file": "/workspace/bert/schedulers.py", "lineno": 88}}
Torch distributed is available.
Torch distributed is initialized.
Torch distributed is available.
Torch distributed is initialized.
Torch distributed is available.
Torch distributed is initialized.
Torch distributed is available.
Torch distributed is initialized.
Torch distributed is available.
Torch distributed is initialized.
Torch distributed is available.
Torch distributed is initialized.
Torch distributed is available.
Torch distributed is initialized.
Torch distributed is available.
Torch distributed is initialized.
node071:32502:32868 [3] NCCL INFO Trees [0] 4/-1/-1->3->2 [1] 4/-1/-1->3->2
node071:32501:32869 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] 3/-1/-1->2->1
node071:32503:32865 [4] NCCL INFO Trees [0] 5/-1/-1->4->3 [1] 5/-1/-1->4->3
node071:32502:32868 [3] NCCL INFO Setting affinity for GPU 3 to 54,00000000,00540000
node071:32501:32869 [2] NCCL INFO Setting affinity for GPU 2 to 01,50000000,00015000
node071:32504:32866 [5] NCCL INFO Trees [0] 6/-1/-1->5->4 [1] 6/-1/-1->5->4
node071:32503:32865 [4] NCCL INFO Setting affinity for GPU 4 to 2a00,00000000,2a000000
node071:32504:32866 [5] NCCL INFO Setting affinity for GPU 5 to 0a8000,0000000a,80000000
node071:32499:32863 [0] NCCL INFO Channel 00/02 :    0   1   2   3   4   5   6   7
node071:32505:32867 [6] NCCL INFO Trees [0] 7/-1/-1->6->5 [1] 7/-1/-1->6->5
node071:32500:32864 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 2/-1/-1->1->0
node071:32506:32870 [7] NCCL INFO Trees [0] -1/-1/-1->7->6 [1] -1/-1/-1->7->6
node071:32499:32863 [0] NCCL INFO Channel 01/02 :    0   1   2   3   4   5   6   7
node071:32505:32867 [6] NCCL INFO Setting affinity for GPU 6 to 02a00000,000002a0,00000000
node071:32500:32864 [1] NCCL INFO Setting affinity for GPU 1 to 05400000,00000540
node071:32499:32863 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1
node071:32506:32870 [7] NCCL INFO Setting affinity for GPU 7 to a8000000,0000a800,00000000
node071:32499:32863 [0] NCCL INFO Setting affinity for GPU 0 to 150000,00000015
node071:32500:32864 [1] NCCL INFO Channel 00 : 1[14000] -> 2[48000] via direct shared memory
node071:32504:32866 [5] NCCL INFO Channel 00 : 5[8b000] -> 6[c1000] via direct shared memory
node071:32506:32870 [7] NCCL INFO Channel 00 : 7[c3000] -> 0[12000] via direct shared memory
node071:32502:32868 [3] NCCL INFO Channel 00 : 3[4a000] -> 4[89000] via direct shared memory
node071:32500:32864 [1] NCCL INFO Channel 01 : 1[14000] -> 2[48000] via direct shared memory
node071:32504:32866 [5] NCCL INFO Channel 01 : 5[8b000] -> 6[c1000] via direct shared memory
node071:32506:32870 [7] NCCL INFO Channel 01 : 7[c3000] -> 0[12000] via direct shared memory
node071:32502:32868 [3] NCCL INFO Channel 01 : 3[4a000] -> 4[89000] via direct shared memory
node071:32499:32863 [0] NCCL INFO Channel 00 : 0[12000] -> 1[14000] via P2P/IPC
node071:32501:32869 [2] NCCL INFO Channel 00 : 2[48000] -> 3[4a000] via P2P/IPC
node071:32503:32865 [4] NCCL INFO Channel 00 : 4[89000] -> 5[8b000] via P2P/IPC
node071:32505:32867 [6] NCCL INFO Channel 00 : 6[c1000] -> 7[c3000] via P2P/IPC
node071:32499:32863 [0] NCCL INFO Channel 01 : 0[12000] -> 1[14000] via P2P/IPC
node071:32501:32869 [2] NCCL INFO Channel 01 : 2[48000] -> 3[4a000] via P2P/IPC
node071:32503:32865 [4] NCCL INFO Channel 01 : 4[89000] -> 5[8b000] via P2P/IPC
node071:32505:32867 [6] NCCL INFO Channel 01 : 6[c1000] -> 7[c3000] via P2P/IPC
node071:32499:32863 [0] NCCL INFO Connected all rings
node071:32501:32869 [2] NCCL INFO Connected all rings
node071:32503:32865 [4] NCCL INFO Connected all rings
node071:32500:32864 [1] NCCL INFO Connected all rings
node071:32505:32867 [6] NCCL INFO Connected all rings
node071:32502:32868 [3] NCCL INFO Connected all rings
node071:32504:32866 [5] NCCL INFO Connected all rings
node071:32506:32870 [7] NCCL INFO Connected all rings
node071:32506:32870 [7] NCCL INFO Channel 00 : 7[c3000] -> 6[c1000] via P2P/IPC
node071:32506:32870 [7] NCCL INFO Channel 01 : 7[c3000] -> 6[c1000] via P2P/IPC
node071:32501:32869 [2] NCCL INFO Channel 00 : 2[48000] -> 1[14000] via direct shared memory
node071:32503:32865 [4] NCCL INFO Channel 00 : 4[89000] -> 3[4a000] via direct shared memory
node071:32505:32867 [6] NCCL INFO Channel 00 : 6[c1000] -> 5[8b000] via direct shared memory
node071:32501:32869 [2] NCCL INFO Channel 01 : 2[48000] -> 1[14000] via direct shared memory
node071:32503:32865 [4] NCCL INFO Channel 01 : 4[89000] -> 3[4a000] via direct shared memory
node071:32505:32867 [6] NCCL INFO Channel 01 : 6[c1000] -> 5[8b000] via direct shared memory
node071:32506:32870 [7] NCCL INFO Connected all trees
node071:32506:32870 [7] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32506:32870 [7] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32500:32864 [1] NCCL INFO Channel 00 : 1[14000] -> 0[12000] via P2P/IPC
node071:32500:32864 [1] NCCL INFO Channel 01 : 1[14000] -> 0[12000] via P2P/IPC
node071:32502:32868 [3] NCCL INFO Channel 00 : 3[4a000] -> 2[48000] via P2P/IPC
node071:32499:32863 [0] NCCL INFO Connected all trees
node071:32499:32863 [0] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32499:32863 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32504:32866 [5] NCCL INFO Channel 00 : 5[8b000] -> 4[89000] via P2P/IPC
node071:32500:32864 [1] NCCL INFO Connected all trees
node071:32500:32864 [1] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32500:32864 [1] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32502:32868 [3] NCCL INFO Channel 01 : 3[4a000] -> 2[48000] via P2P/IPC
node071:32504:32866 [5] NCCL INFO Channel 01 : 5[8b000] -> 4[89000] via P2P/IPC
node071:32502:32868 [3] NCCL INFO Connected all trees
node071:32502:32868 [3] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32502:32868 [3] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32504:32866 [5] NCCL INFO Connected all trees
node071:32504:32866 [5] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32504:32866 [5] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32505:32867 [6] NCCL INFO Connected all trees
node071:32505:32867 [6] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32505:32867 [6] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32501:32869 [2] NCCL INFO Connected all trees
node071:32501:32869 [2] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32501:32869 [2] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32503:32865 [4] NCCL INFO Connected all trees
node071:32503:32865 [4] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 8/8/512
node071:32503:32865 [4] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
node071:32499:32863 [0] NCCL INFO comm 0x7ff358008fb0 rank 0 nranks 8 cudaDev 0 busId 12000 - Init COMPLETE
node071:32499:32499 [0] NCCL INFO Launch mode Parallel
node071:32500:32864 [1] NCCL INFO comm 0x7ff4dc008fb0 rank 1 nranks 8 cudaDev 1 busId 14000 - Init COMPLETE
node071:32502:32868 [3] NCCL INFO comm 0x7ff4e0008fb0 rank 3 nranks 8 cudaDev 3 busId 4a000 - Init COMPLETE
node071:32501:32869 [2] NCCL INFO comm 0x7ff37c008fb0 rank 2 nranks 8 cudaDev 2 busId 48000 - Init COMPLETE
node071:32506:32870 [7] NCCL INFO comm 0x7ff4e8008fb0 rank 7 nranks 8 cudaDev 7 busId c3000 - Init COMPLETE
node071:32504:32866 [5] NCCL INFO comm 0x7ff374008fb0 rank 5 nranks 8 cudaDev 5 busId 8b000 - Init COMPLETE
node071:32503:32865 [4] NCCL INFO comm 0x7ff37c008fb0 rank 4 nranks 8 cudaDev 4 busId 89000 - Init COMPLETE
node071:32505:32867 [6] NCCL INFO comm 0x7ff4e0008fb0 rank 6 nranks 8 cudaDev 6 busId c1000 - Init COMPLETE
:::MLLOG {"namespace": "", "time_ms": 1635311745061, "event_type": "INTERVAL_END", "key": "init_stop", "value": null, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1370}}
:::MLLOG {"namespace": "", "time_ms": 1635311745317, "event_type": "INTERVAL_START", "key": "run_start", "value": null, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1371}}
:::MLLOG {"namespace": "", "time_ms": 1635311745365, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1382, "epoch_num": 1}}
:::MLLOG {"namespace": "", "time_ms": 1635311745367, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1384, "first_epoch_num": 1, "epoch_count": 1}}
parsed args:
Namespace(allreduce_post_accumulation=True, allreduce_post_accumulation_fp16=True, bert_config_path='/workspace/phase1/bert_config.json', bert_model='bert-large-uncased', bypass_amp=False, cache_eval_data=True, checkpoint_activations=False, cuda_graph_mode='segmented', ddp_type='apex', dense_seq_output=True, device=device(type='cuda', index=0), disable_apex_softmax=False, disable_fuse_mask=False, disable_fuse_qkv=False, disable_fuse_scale=False, distributed_lamb=True, do_train=True, dwu_e5m2_allgather=False, dwu_group_size=0, dwu_num_ag_pg=1, dwu_num_ar_pg=1, dwu_num_blocks=1, dwu_num_chunks=1, dwu_num_rs_pg=1, dwu_overlap_reductions=False, enable_fuse_dropout=False, enable_stream=False, eval_batch_size=16, eval_dir='/workspace/evaldata', eval_iter_samples=150000, eval_iter_start_samples=150000, exchange_padding=True, fp16=True, fused_bias_fc=True, fused_bias_mha=True, fused_dropout_add=True, fused_gelu_bias=False, fused_mha=False, gradient_accumulation_steps=1, init_checkpoint='/workspace/phase1/model.ckpt-28252.pt', init_tf_checkpoint=None, input_dir='/workspace/data_phase2', keep_n_most_recent_checkpoints=20, learning_rate=0.00035, local_rank=0, log_freq=0.0, loss_scale=0.0, max_iterations_per_graph=4, max_predictions_per_seq=76, max_samples_termination=4500000.0, max_seq_length=512, max_steps=15000.0, min_samples_to_start_checkpoints=3000000, n_gpu=8, num_epochs_to_generate_seeds_for=2, num_eval_examples=10000, num_samples_per_checkpoint=500000, opt_lamb_beta_1=0.9, opt_lamb_beta_2=0.999, output_dir='/results', pad=False, pad_fmha=False, phase2=True, resume_from_checkpoint=False, resume_step=0, seed=7573, skip_checkpoint=True, start_warmup_step=0.0, target_mlm_accuracy=0.72, train_batch_size=48, train_mlm_accuracy_window_size=0, unpad=True, unpad_fmha=True, use_cuda_graph=False, use_ddp=False, use_env=False, use_gradient_as_bucket_view=False, warmup_proportion=0.0, warmup_steps=0.0, weight_decay_rate=0.01)
epoch: 1
:::MLLOG {"namespace": "", "time_ms": 1635311926677, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.37343981862068176, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 391, 'eval_loss': 4.1028828620910645, 'eval_mlm_accuracy': 0.37343981862068176}
:::MLLOG {"namespace": "", "time_ms": 1635312103533, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.40339767932891846, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 782, 'eval_loss': 3.853482246398926, 'eval_mlm_accuracy': 0.40339767932891846}
:::MLLOG {"namespace": "", "time_ms": 1635312285156, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.4520788788795471, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 1172, 'eval_loss': 3.3984508514404297, 'eval_mlm_accuracy': 0.4520788788795471}
:::MLLOG {"namespace": "", "time_ms": 1635312468548, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.5444090366363525, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 1563, 'eval_loss': 2.619103193283081, 'eval_mlm_accuracy': 0.5444090366363525}
:::MLLOG {"namespace": "", "time_ms": 1635312653647, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.6754422187805176, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 1954, 'eval_loss': 1.6072050333023071, 'eval_mlm_accuracy': 0.6754422187805176}
:::MLLOG {"namespace": "", "time_ms": 1635312837304, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.7045243978500366, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 2344, 'eval_loss': 1.4051032066345215, 'eval_mlm_accuracy': 0.7045243978500366}
:::MLLOG {"namespace": "", "time_ms": 1635313014917, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.7087767124176025, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 2735, 'eval_loss': 1.3781960010528564, 'eval_mlm_accuracy': 0.7087767124176025}
:::MLLOG {"namespace": "", "time_ms": 1635313194567, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.7104766964912415, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 3125, 'eval_loss': 1.3635191917419434, 'eval_mlm_accuracy': 0.7104766964912415}
:::MLLOG {"namespace": "", "time_ms": 1635313378682, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.7124826312065125, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 3516, 'eval_loss': 1.3578852415084839, 'eval_mlm_accuracy': 0.7124826312065125}
:::MLLOG {"namespace": "", "time_ms": 1635313563536, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.7134867310523987, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 3907, 'eval_loss': 1.3521175384521484, 'eval_mlm_accuracy': 0.7134867310523987}
:::MLLOG {"namespace": "", "time_ms": 1635313747296, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.7144021391868591, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 4297, 'eval_loss': 1.342239499092102, 'eval_mlm_accuracy': 0.7144021391868591}
:::MLLOG {"namespace": "", "time_ms": 1635313932555, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.7151026725769043, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 4688, 'eval_loss': 1.3388437032699585, 'eval_mlm_accuracy': 0.7151026725769043}
:::MLLOG {"namespace": "", "time_ms": 1635314117344, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.7157331705093384, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 5079, 'eval_loss': 1.3352030515670776, 'eval_mlm_accuracy': 0.7157331705093384}
:::MLLOG {"namespace": "", "time_ms": 1635314300234, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.7162889242172241, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 5469, 'eval_loss': 1.331992268562317, 'eval_mlm_accuracy': 0.7162889242172241}
:::MLLOG {"namespace": "", "time_ms": 1635314481474, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.7168190479278564, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 5860, 'eval_loss': 1.328584909439087, 'eval_mlm_accuracy': 0.7168190479278564}
:::MLLOG {"namespace": "", "time_ms": 1635314660546, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.7177460789680481, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 6250, 'eval_loss': 1.325112223625183, 'eval_mlm_accuracy': 0.7177460789680481}
:::MLLOG {"namespace": "", "time_ms": 1635314836746, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.717909574508667, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 6641, 'eval_loss': 1.3225300312042236, 'eval_mlm_accuracy': 0.717909574508667}
:::MLLOG {"namespace": "", "time_ms": 1635315014608, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.7181921005249023, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 7032, 'eval_loss': 1.3206756114959717, 'eval_mlm_accuracy': 0.7181921005249023}
:::MLLOG {"namespace": "", "time_ms": 1635315191635, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.7183251976966858, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 7422, 'eval_loss': 1.3167133331298828, 'eval_mlm_accuracy': 0.7183251976966858}
:::MLLOG {"namespace": "", "time_ms": 1635315371709, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.7189907431602478, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 7813, 'eval_loss': 1.3132829666137695, 'eval_mlm_accuracy': 0.7189907431602478}
:::MLLOG {"namespace": "", "time_ms": 1635315552020, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.7193363308906555, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 8204, 'eval_loss': 1.3141568899154663, 'eval_mlm_accuracy': 0.7193363308906555}
:::MLLOG {"namespace": "", "time_ms": 1635315733500, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.7196889519691467, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 8594, 'eval_loss': 1.3126946687698364, 'eval_mlm_accuracy': 0.7196889519691467}
:::MLLOG {"namespace": "", "time_ms": 1635315915099, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.7199411392211914, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 8985, 'eval_loss': 1.3071945905685425, 'eval_mlm_accuracy': 0.7199411392211914}
:::MLLOG {"namespace": "", "time_ms": 1635316090277, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.7203054428100586, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1579, "epoch_num": 1}}
{'global_steps': 9375, 'eval_loss': 1.3060147762298584, 'eval_mlm_accuracy': 0.7203054428100586}
0.720305 > 0.720000, Target MLM Accuracy reached at 9375
(1, 9383.0) {'final_loss': 0.0}
:::MLLOG {"namespace": "", "time_ms": 1635316090447, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1710, "first_epoch_num": 1}}
:::MLLOG {"namespace": "", "time_ms": 1635316090447, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1713, "epoch_num": 1}}
:::MLLOG {"namespace": "", "time_ms": 1635316090447, "event_type": "POINT_IN_TIME", "key": "train_samples", "value": 3600000, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1726}}
:::MLLOG {"namespace": "", "time_ms": 1635316090447, "event_type": "POINT_IN_TIME", "key": "eval_samples", "value": 10000, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1729}}
:::MLLOG {"namespace": "", "time_ms": 1635316090448, "event_type": "INTERVAL_END", "key": "run_stop", "value": null, "metadata": {"file": "/workspace/bert/run_pretraining.py", "lineno": 1732, "status": "success"}}
{'e2e_time': 4368.941299915314, 'training_sequences_per_second': 1323.0509577419202, 'final_loss': 0.0, 'raw_train_time': 4353.573810815811}
+ set +x
ENDING TIMING RUN AT 2021-10-27 06:28:12 AM
RESULT,bert,7573,4373,,2021-10-27 05:15:19 AM
